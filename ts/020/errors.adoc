= Errors

Errors SHOULD go to stderr. This means that, when commands are piped together, the error messages will get displayed to the user but the standard output will get piped into the next command.

Error messages SHOULD be sent to stderr whenever a command returns a non-zero exit code. The error message MUST provide sufficient information to help the user fix the problem identified by the link:./exit-codes.adoc[exit code].

But do not treat stderr like a log file. Don't print log-level labels here — "ERROR", "WARN", etc. — or any other extraneous contextual information, unless your program was explicitly invoked in verbose mode.

It is RECOMMENDED to use only a limited amount of color in stderr output, or no color at all. Prefer to use only indentation and other plain-text formatting to give the output structure. However, it can be beneficial to use some color — the convention for errors is to use red — to draw the user's attention to the important bits of information in verbose outputs. The same rules apply as for stdout — disable colors in the stderr output in these circumstances:

* When stderr is not an interactive terminal (a TTY).
* When an environment variable named `NO_COLOR` exists.
* When an environment variable named `[APP]_NO_COLOR` exists, where `[APP]` is a prefix identifying your program.

Catch all errors and rewrite them for humans. Think of it like a conversation, where the user has done something wrong and the program is guiding them in the right direction. Example:

----
Can't write to file.txt. You might need to make it writable. Try running 'chmod +w file.txt'.
----

Signal-to-noise ratio is crucial. The more irrelevant output you produce, the longer it's going to take the user to figure out what went wrong. If your program produces multiple errors of the same type, consider grouping them under a single explanatory header instead of printing many similar-looking lines.

Consider where the user will look first. Put the most important information at the end of the error output, not the start. The eye will be drawn to red text, so use it intentionally and sparingly.

If there is an unexpected or unexplainable error, provide debug and traceback information, and instructions on how to submit a bug. That said, don't forget about the signal-to-noise ratio: you don't want to overwhelm the user with information they don't understand. Not all users are developers like you! Consider, for example, writing scary-looking stack traces to a debug log, instead of printing it to the terminal.

Make it effortless to submit bug reports. One nice thing you can do is provide a URL and have the bug submission form pre-populated with as much information as possible.

The GNU coding standards have more guidance on https://www.gnu.org/prep/standards/html_node/Errors.html[formatting error messages].
